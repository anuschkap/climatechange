library(haven)
library(dplyr)
library(foreign)
library(tidyverse)
library(labelled)
library(ggplot2)
ess2016 <- haven::read_sav("/Users/anuschka/Documents/gesis_dir/ess/ESS8e02_2.sav", encoding="latin1")
View(ess2016)
ess16sel <- ess %>% filter(cntry=="NL")
ess16sel <- ess2016 %>% filter(cntry=="NL")
View(ess16sel)
ess16sel <- ess2016 %>% filter(cntry=="NL")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, lkredcc, lklmten, ccnthum, ccrdprs, wrlclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrborn, prtvtfnl, lrscale, cntry)
ess16sel <- ess2016 %>% filter(cntry=="NL")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, lkredcc, lklmten, ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrborn, prtvtfnl, lrscale, cntry)
ess16sel <- ess2016 %>% filter(cntry=="NL")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, lkredcc, lklmten, ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvtfnl, lrscale, cntry)
View(ess16sel)
attributes(ess16sel$lkredcc)
table(ess16sel$lkredcc, useNA = "always")
attributes(ess16sel$lklmten)
table(ess16sel$lklmten, useNA = "always")
attributes(ess16sel$ccnthum)
table(ess16sel$ccnthum, useNA = "always")
attributes(ess16sel$ccrdprs)
table(ess16sel$ccrdprs, useNA = "always")
attributes(ess16sel$wrclmch)
table(ess16sel$wrclmch, useNA = "always")
ess16sel$lkredccn <- as.numeric(lkredccn)
ess16sel$lkredccn <- as.numeric(ess16sel$lkredccn)
ess16sel$lkredccn <- as.numeric(ess16sel$lkredcc)
ess16sel$lkredcc_cat <- NA
ess16sel$lkredcc_cat[ess16sel$lkredccn >= 0 & ess16sel$lkredccn <= 2] <- 1
ess16sel$lkredcc_cat[ess16sel$lkredccn ==3 | ess16sel$lkredccn ==4] <- 2
ess16sel$lkredcc_cat[ess16sel$lkredccn ==5 | ess16sel$lkredccn ==6] <- 3
ess16sel$lkredcc_cat[ess16sel$lkredccn ==7 | ess16sel$lkredccn ==8] <- 4
ess16sel$lkredcc_cat[ess16sel$lkredccn ==9 | ess16sel$lkredccn ==10] <- 5
table(ess16sel$lkredcc_cat, useNA = "always")
table(ess16sel$lkredcc, useNA = "always")
ess16sel$lklmtenn <- as.numeric(ess16sel$lklmten)
ess16sel$lklmten_cat <- NA
ess16sel$lklmten_cat[ess16sel$lklmtenn >= 0 & ess16sel$lklmtenn <= 2] <- 1
ess16sel$lklmten_cat[ess16sel$lklmtenn ==3 | ess16sel$lklmtenn ==4] <- 2
ess16sel$lklmten_cat[ess16sel$lklmtenn ==5 | ess16sel$lklmtenn ==6] <- 3
ess16sel$lklmten_cat[ess16sel$lklmtenn ==7 | ess16sel$lklmtenn ==8] <- 4
ess16sel$lklmten_cat[ess16sel$lklmtenn ==9 | ess16sel$lklmtenn ==10] <- 5
table(ess16sel$lklmten_cat, useNA = "always")
table(ess16sel$lklmten, useNA = "always")
ess16sel$ccrdprsn <- as.numeric(ess16sel$ccrdprs)
ess16sel$ccrdprsn_cat <- NA
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn >= 0 & ess16sel$ccrdprsn <= 2] <- 1
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==3 | ess16sel$ccrdprsn ==4] <- 2
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==5 | ess16sel$ccrdprsn ==6] <- 3
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==7 | ess16sel$ccrdprsn ==8] <- 4
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==9 | ess16sel$ccrdprsn ==10] <- 5
table(ess16sel$ccrdprsn_cat, useNA = "always")
table(ess16sel$ccrdprsn, useNA = "always")
mean(ccrdprsn, na.rm=T)
mean(ess16sel$ccrdprsn, na.rm=T)
mean(ess16sel$ccrdprsn_cat, na.rm=T)
mean(ess16sel$lklmtenn, na.rm=T)
mean(ess16sel$lklmten_cat, na.rm=T)
mean(ess16sel$lkredccn, na.rm=T)
mean(ess16sel$lkredccn_cat, na.rm=T)
mean(ess16sel$lkredcc_cat, na.rm=T)
list_na <- colnames(ess16sel)[ apply(ess16sel, 2, anyNA) ]
list_na
average_missing <- apply(evssel[,colnames(evssel) %in% list_na],
2,
mean,
na.rm =  TRUE)
average_missing <- apply(ess16sel[,colnames(ess16sel) %in% list_na],
2,
mean,
na.rm =  TRUE)
average_missing
ess16sel_replace <- ess16sel %>%
mutate(eisced_mis  = ifelse(is.na(eisced), average_missing[7], eisced),
edlvenl_mis = ifelse(is.na(edlvenl), average_missing[9], edlvenl),
eduyrs_mis = ifelse(is.na(eduyrs), average_missing[10], eduyrs),
lr_mis = ifelse(is.na(lrscale), average_missing[13], lrscale))
View(ess16sel_replace)
table(ess16sel_replace$eisced_mis)
table(ess16sel_replace$edlvenl_mis)
table(ess16sel_replace$edlvenl_mis, useNA = "always")
table(ess16sel_replace$edlvenl, useNA = "always")
save(evs16sel, file="/Users/anuschka/Documents/gesis_dir/ess/ess16sel.Rdata")
save(ess16sel, file="/Users/anuschka/Documents/gesis_dir/ess/ess16sel.Rdata")
ess16sel_replace$edlvenl[ess16sel_replace$edlvenl=="5555"] <- NA
ess16sel$edlvenl[ess16sel$edlvenl=="5555"] <- NA
ess16sel$edlvenl[ess16sel$edlvenl==5555] <- NA
table(ess16sel$edlvenl, useNA = "always")
table(ess16sel$eduyrs, useNA = "always")
table(ess16sel$gndr, useNA = "always")
table(ess16sel$eisced, useNA = "always")
ess16sel$eisced[ess16sel$eisced==55] <- NA
table(ess16sel$eisced, useNA = "always")
table(ess16sel$lrscale, useNA = "always")
list_na <- colnames(ess16sel)[ apply(ess16sel, 2, anyNA) ]
list_na
average_missing <- apply(ess16sel[,colnames(ess16sel) %in% list_na],
2,
mean,
na.rm =  TRUE)
average_missing
ess16sel_replace <- ess16sel %>%
mutate(eisced_mis  = ifelse(is.na(eisced), average_missing[7], eisced),
edlvenl_mis = ifelse(is.na(edlvenl), average_missing[9], edlvenl),
eduyrs_mis = ifelse(is.na(eduyrs), average_missing[10], eduyrs),
lr_mis = ifelse(is.na(lrscale), average_missing[13], lrscale))
table(ess16sel_replace$edlvenl_mis, useNA = "always")
table(ess16sel_replace$eisced_mis, useNA = "always")
ess2020 <- haven::read_sav("/Users/anuschka/Documents/gesis_dir/ess/ESS10.sav", encoding="latin1")
View(ess2020)
ess20sel <- ess2020 %>% filter(cntry=="NL")
ess20sel <- ess2020 %>% filter(cntry=="NL")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, lkredcc, lklmten, ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvtfnl, lrscale, cntry)
attributes(ess2020$testic34)
table(ess2020$testic34)
table(ess20sel$testic34)
View(ess20sel)
table(ess20sel$testic40)
table(ess20sel$testic41)
table(ess20sel$testic40)
table(ess20sel$testic37)
attributes(ess2020$testic33)
attributes(ess2020$admrclc)
table(ess20sel$testic41, useNA = "always")
table(ess20sel$testic40, useNA = "always")
table(ess20sel$testic37, useNA = "always")
table(ess20sel$ccnthum, useNA = "always")
table(ess20sel$ccrdprs, useNA = "always")
table(ess20sel$wrclmch, useNA = "always")
ess20sel <- ess2020 %>% filter(cntry=="NL")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvtfnl, lrscale, cntry)
ess20sel <- ess2020 %>% filter(cntry=="NL")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvthnl, lrscale)
View(ess20sel)
table(ess20sel$ccrdprs, useNA = "always")
ess20sel$ccrdprsn <- as.numeric(ess20sel$ccrdprs)
ess20sel$ccrdprsn_cat <- NA
ess20sel$ccrdprsn_cat[ess20sel$ccrdprsn >= 0 & ess20sel$ccrdprsn <= 2] <- 1
ess20sel$ccrdprsn_cat[ess20sel$ccrdprsn ==3 | ess20sel$ccrdprsn ==4] <- 2
ess20sel$ccrdprsn_cat[ess20sel$ccrdprsn ==5 | ess20sel$ccrdprsn ==6] <- 3
ess20sel$ccrdprsn_cat[ess20sel$ccrdprsn ==7 | ess20sel$ccrdprsn ==8] <- 4
ess20sel$ccrdprsn_cat[ess20sel$ccrdprsn ==9 | ess20sel$ccrdprsn ==10] <- 5
table(ess20sel$ccrdprsn_cat, useNA = "always")
table(ess20sel$ccrdprsn, useNA = "always")
table(ess20sel$edlvenl, useNA = "always")
ess16sel$edlvenl[ess16sel$edlvenl==5555] <- NA
table(ess20sel$edlvenl, useNA = "always")
ess20sel$edlvenl[ess20sel$edlvenl==5555] <- NA
table(ess20sel$edlvenl, useNA = "always")
table(ess20sel$eduyrs, useNA = "always")
table(ess20sel$gndr, useNA = "always")
table(ess20sel$eisced, useNA = "always")
ess20sel$eisced[ess20sel$eisced==55] <- NA
table(ess20sel$eisced, useNA = "always")
table(ess20sel$lrscale, useNA = "always")
list_na2- <- colnames(ess20sel)[ apply(ess20sel, 2, anyNA) ]
list_na2 <- colnames(ess20sel)[ apply(ess20sel, 2, anyNA) ]
list_na2
average_missing2 <- apply(ess20sel[,colnames(ess20sel) %in% list_na2],
2,
mean,
na.rm =  TRUE)
average_missing2
ess20sel_replace <- ess20sel %>%
mutate(eisced_mis  = ifelse(is.na(eisced), average_missing2[5], eisced),
edlvenl_mis = ifelse(is.na(edlvenl), average_missing2[7], edlvenl),
eduyrs_mis = ifelse(is.na(eduyrs), average_missing2[8], eduyrs),
lr_mis = ifelse(is.na(lrscale), average_missing2[13], lrscale),
age_mis = ifelse(is.na(agea), average_missing2[10], agea))
table(ess20sel_replace$eisced_mis, useNA = "always")
table(ess20sel_replace$edlvenl_mis, useNA = "always")
save(ess20sel, file="/Users/anuschka/Documents/climatechange/climatechange/ess20sel.Rdata")
save(ess16sel_replace, file="/Users/anuschka/Documents/climatechange/climatechange/ess16sel_mis.Rdata")
save(ess20sel_replace, file="/Users/anuschka/Documents/climatechange/climatechange/ess20sel_mis.Rdata")
table(ess20sel_replace$ccnthum, useNA = "always")
table(ess20sel$ccnthum, useNA = "always")
table(ess20sel$ccrdprs, useNA = "always")
table(ess20sel$wrclmch, useNA = "always")
ess_total <- merge(ess16sel_replace, ess20sel_replace, all = TRUE, by = "idno")
head(ess_total)
ess_total <- reshape(ess_total, timevar = "essround", idvar = "idno", direction = "long")
?reshapeLong
?reshape
ess_total <- reshape(ess_total, timevar = "essround", idvar = "idno", direction = "long", varying = 1:ncol(ess_total))
View(ess_total)
ess_total <- merge(ess16sel_replace, ess20sel_replace, all.x = TRUE, by = "idno")
head(ess_total)
head(ess_total)
View(ess_total)
ess_total <- rbind(ess16sel_replace, ess20sel_replace)
View(ess20sel_replace)
ess20sel_replace$agea <- ess20sel_replace$age_mis
ess16sel_replace <- ess16sel_replace %>% select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, ccnthum, ccrdprs, wrclmch, marsts, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvtfnl, lrscale, ccrdprsn_cat, eisced_mis, edlvenl_mis, eduyrs_mis, lr_mis)
ess20sel_replace <- ess20sel_replace %>% select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, ccnthum, ccrdprs, wrclmch, marsts, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvttnl, lrscale, ccrdprsn_cat, eisced_mis, edlvenl_mis, eduyrs_mis, lr_mis)
ess20sel_replace <- ess20sel_replace %>% select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight, ccnthum, ccrdprs, wrclmch, marsts, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvthnl, lrscale, ccrdprsn_cat, eisced_mis, edlvenl_mis, eduyrs_mis, lr_mis)
ess_total <- rbind(ess16sel_replace, ess20sel_replace)
rename(ess20sel_replace, prtvtfnl=prtvthnl)
ess_total <- rbind(ess16sel_replace, ess20sel_replace)
View(ess16sel_replace)
View(ess20sel_replace)
rename(ess20sel_replace, prtvtfnl=prtvthnl)
rename(ess20sel_replace, prtvtfnl = prtvthnl)
rename(ess20sel_replace, prtvthnl = prtvtfnl)
rename(ess20sel_replace, prtvtfnl = prtvthnl)
ess20sel_replace <- rename(ess20sel_replace, prtvtfnl = prtvthnl)
ess_total <- rbind(ess16sel_replace, ess20sel_replace)
remove_var_label(ess16sel_replace, ess20sel_replace)
remove_var_label(ess16sel_replace)
remove_var_label(ess20sel_replace)
ess_total <- rbind(ess16sel_replace, ess20sel_replace)
remove_val_label(ess16sel_replace)
remove_val_label(ess16sel_replace)
sapply(ess16sel_replace, haven::as_factor)
sapply(ess20sel_replace, haven::as_factor)
ess_total <- rbind(ess16sel_replace, ess20sel_replace)
View(ess16sel_replace)
save(ess20sel_replace, file="/Users/anuschka/Documents/climatechange/climatechange/ess20sel_mis.Rdata")
save(ess16sel_replace, file="/Users/anuschka/Documents/climatechange/climatechange/ess16sel_mis.Rdata")
ess_total <- rbind(ess16sel_replace, ess20sel_replace)
issp1993 <- foreign::read.spss("/Users/anuschka/Documents/gesis_dir/issp/issp1993.sav", use.value.labels = T,  to.data.frame = T)
issp2010 <- foreign::read.spss("/Users/anuschka/Documents/gesis_dir/issp/issp2010.sav", use.value.labels = T, to.data.frame = T)
View(issp1993)
View(issp2010)
View(issp1993)
issp1993 <- issp1993 %>%
select(V9, V10 )
issp2010 <- issp2010 %>%
select(v20, v21)
issp2010 <- rename(issp2010, V9 = v20, V10 = v21)
issptot <- rbind(issp1993, issp2010)
View(issptot)
rm(list = ls())
ess2016 <- foreign::read.spss("/Users/anuschka/Documents/gesis_dir/ess/ESS8e02_2.sav", use.value.labels = T,  to.data.frame = T)
ess16sel <- ess2016 %>% filter(cntry=="NL")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight,ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvtfnl, lrscale)
View(ess16sel)
View(ess2016)
ess16sel <- ess2016 %>% filter(cntry=="The Netherlands")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight,ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvtfnl, lrscale)
ess16sel <- ess2016 %>% filter(cntry=="Netherlands")  %>%
select(name, essround, proddate, idno, dweight, pspwght, pweight, anweight,ccnthum, ccrdprs, wrclmch, marsts, eisced, edulvlb, edlvenl, eduyrs, mainact, gndr, agea, yrbrn, prtvtfnl, lrscale)
ess16sel$ccrdprsn <- as.numeric(ess16sel$ccrdprs)
ess16sel$ccrdprsn_cat <- NA
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn >= 0 & ess16sel$ccrdprsn <= 2] <- 1
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==3 | ess16sel$ccrdprsn ==4] <- 2
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==5 | ess16sel$ccrdprsn ==6] <- 3
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==7 | ess16sel$ccrdprsn ==8] <- 4
ess16sel$ccrdprsn_cat[ess16sel$ccrdprsn ==9 | ess16sel$ccrdprsn ==10] <- 5
table(ess16sel$ccrdprsn_cat, useNA = "always")
table(ess16sel$ccrdprsn, useNA = "always")
table(ess16sel$edlvenl, useNA = "always") # I want to code 5555 as missing.
ess16sel$edlvenl[ess16sel$edlvenl==5555] <- NA
table(ess16sel$eduyrs, useNA = "always")
table(ess16sel$gndr, useNA = "always")
table(ess16sel$eisced, useNA = "always")
ess16sel$eisced[ess16sel$eisced==55] <- NA
table(ess16sel$lrscale, useNA = "always")
list_na <- colnames(ess16sel)[ apply(ess16sel, 2, anyNA) ]
list_na
average_missing <- apply(ess16sel[,colnames(ess16sel) %in% list_na],
2,
mean,
na.rm =  TRUE)
average_missing
ess16sel$eisced <- as.numeric(ess16sel$eisced)
ess16sel$eisced <- as.numeric(ess16sel$eisced)
ess16sel$edlvenl <- as.numeric(ess16sel$edlvenl)
ess16sel$eduyrs <- as.numeric(ess16sel$eduyrs)
ess16sel$lrscale <- as.numeric(ess16sel$lrscale)
average_missing <- apply(ess16sel[,colnames(ess16sel) %in% list_na],
2,
mean,
na.rm =  TRUE)
average_missing
load("/Users/anuschka/Documents/climatechange/climatechange/ess16sel_mis.Rdata")
load("/Users/anuschka/Documents/climatechange/climatechange/ess20sel_mis.Rdata")
esstotal <- dplyr::bind_rows(ess16sel_replace, ess20sel_replace)
View(esstotal)
mean(esstotal$ccnthum[essround==8])
mean(esstotal$ccnthum[esstotal$essround==8])
attributes(ess_total$ccnthum)
attributes(esstotal$ccnthum)
esstotal$ccnthum <- as.numeric(esstotal$ccnthum)
mean(esstotal$ccnthum[esstotal$essround==8])
mean(esstotal$ccnthum[esstotal$essround=="8"])
esstotal$essround=="8"
save(esstotal, file="/Users/anuschka/Documents/climatechange/climatechange/esstotal.Rdata")
